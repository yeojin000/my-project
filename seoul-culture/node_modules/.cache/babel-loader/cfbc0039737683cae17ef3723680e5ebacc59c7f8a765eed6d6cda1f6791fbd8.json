{"ast":null,"code":"var _s = $RefreshSig$();\n// src/hooks/useEvents.js\nimport { useEffect, useState } from \"react\";\n\n// \"2025-12-30 00:00:00.0\" -> ms\nfunction parseDateTimeLoose(s) {\n  if (!s) return NaN;\n  // 공백, 줄바꿈 제거\n  const t = String(s).trim().replace(/\\s+/g, \" \");\n  // \"YYYY-MM-DD HH:mm:ss.S\" 형태는 공백을 'T'로 바꿔도 파싱됨\n  const isoish = t.replace(\" \", \"T\");\n  const ms = Date.parse(isoish);\n  return Number.isNaN(ms) ? NaN : ms;\n}\n\n// \"2025-12-25~2025-12-26\" -> [ms, ms]\nfunction parseDateRange(s) {\n  if (!s) return [NaN, NaN];\n  const [a, b] = String(s).split(\"~\").map(v => v && v.trim());\n  const sMs = a ? Date.parse(a) : NaN;\n  const eMs = b ? Date.parse(b) : sMs;\n  return [sMs, eMs];\n}\n\n// 카테고리 상위 매핑\nfunction toHighLevelCategory(codename = \"\", themecode = \"\") {\n  const c = String(codename);\n  if ([\"콘서트\", \"클래식\", \"국악\", \"무용\", \"연극\", \"뮤지컬/오페라\", \"축제-기타\"].some(k => c.includes(k))) return \"공연\";\n  if (c.includes(\"전시/미술\")) return \"전시\";\n  if (c.includes(\"교육/체험\") || String(themecode).includes(\"교육\")) return \"교육/체험\";\n  return \"기타\";\n}\n\n// URL 중간에 공백 섞여 온 케이스 보정\nfunction cleanUrl(u) {\n  if (!u) return \"\";\n  return String(u).replace(/\\s+/g, \"\");\n}\n\n// 자치구 오타 보정(예: \"관구악\" -> \"관악구\")\nfunction normalizeGuName(g) {\n  const s = String(g || \"\").trim();\n  if (s === \"관구악\") return \"관악구\";\n  return s || \"기타\";\n}\n\n// --- 핵심: 어떤 JSON이 와도 공통 필드로 정규화 ---\nfunction normalize(raw) {\n  var _raw$cultureEventInfo;\n  if (!raw) return [];\n\n  // ① 정적 JSON(예: { DESCRIPTION, DATA: [...] }) 형태\n  if (raw.DATA && Array.isArray(raw.DATA)) {\n    return raw.DATA.map((e, idx) => {\n      // 수치형 타임스탬프(ms)로 오는 케이스 지원\n      const sMs = Number(e.strtdate);\n      const eMs = Number(e.end_date);\n      return {\n        id: `${e.title || \"ev\"}-${e.strtdate || e.date || idx}`,\n        title: e.title,\n        categoryHL: toHighLevelCategory(e.codename, e.themecode),\n        dateText: e.date,\n        place: e.place,\n        area: normalizeGuName(e.guname),\n        img: e.main_img || \"/images/no-image.png\",\n        link: cleanUrl(e.hmpg_addr || e.org_link),\n        startMs: Number.isNaN(sMs) ? NaN : sMs,\n        endMs: Number.isNaN(eMs) ? sMs : eMs\n      };\n    });\n  }\n\n  // ② 서울시 OpenAPI 응답({ cultureEventInfo: { row: [...] } })\n  const rows = (_raw$cultureEventInfo = raw.cultureEventInfo) === null || _raw$cultureEventInfo === void 0 ? void 0 : _raw$cultureEventInfo.row;\n  if (Array.isArray(rows)) {\n    return rows.map((r, idx) => {\n      // 대문자 키 정리\n      const title = r.TITLE;\n      const dateText = r.DATE;\n      const [sFromDate, sToDate] = parseDateRange(dateText);\n      const sMs = parseDateTimeLoose(r.STRTDATE) || sFromDate;\n      const eMs = parseDateTimeLoose(r.END_DATE) || sToDate || sMs;\n      return {\n        id: `${title || \"ev\"}-${r.STRTDATE || r.DATE || idx}`,\n        title,\n        categoryHL: toHighLevelCategory(r.CODENAME, r.THEMECODE),\n        dateText,\n        place: r.PLACE,\n        area: normalizeGuName(r.GUNAME),\n        img: r.MAIN_IMG || \"/images/no-image.png\",\n        link: cleanUrl(r.HMPG_ADDR || r.ORG_LINK),\n        startMs: sMs,\n        endMs: eMs\n      };\n    });\n  }\n  return [];\n}\nexport default function useEvents(source = \"/data/seoul_api.json\") {\n  _s();\n  const [events, setEvents] = useState([]);\n  useEffect(() => {\n    fetch(source).then(res => res.json()).then(json => setEvents(normalize(json))).catch(() => setEvents([]));\n  }, [source]);\n  return events;\n}\n_s(useEvents, \"j18ueuia/psAZ/XawE3UyqzOWsE=\");","map":{"version":3,"names":["useEffect","useState","parseDateTimeLoose","s","NaN","t","String","trim","replace","isoish","ms","Date","parse","Number","isNaN","parseDateRange","a","b","split","map","v","sMs","eMs","toHighLevelCategory","codename","themecode","c","some","k","includes","cleanUrl","u","normalizeGuName","g","normalize","raw","_raw$cultureEventInfo","DATA","Array","isArray","e","idx","strtdate","end_date","id","title","date","categoryHL","dateText","place","area","guname","img","main_img","link","hmpg_addr","org_link","startMs","endMs","rows","cultureEventInfo","row","r","TITLE","DATE","sFromDate","sToDate","STRTDATE","END_DATE","CODENAME","THEMECODE","PLACE","GUNAME","MAIN_IMG","HMPG_ADDR","ORG_LINK","useEvents","source","_s","events","setEvents","fetch","then","res","json","catch"],"sources":["C:/my-project/seoul-culture/src/hooks/useEvents.js"],"sourcesContent":["// src/hooks/useEvents.js\r\nimport { useEffect, useState } from \"react\";\r\n\r\n// \"2025-12-30 00:00:00.0\" -> ms\r\nfunction parseDateTimeLoose(s) {\r\n  if (!s) return NaN;\r\n  // 공백, 줄바꿈 제거\r\n  const t = String(s).trim().replace(/\\s+/g, \" \");\r\n  // \"YYYY-MM-DD HH:mm:ss.S\" 형태는 공백을 'T'로 바꿔도 파싱됨\r\n  const isoish = t.replace(\" \", \"T\");\r\n  const ms = Date.parse(isoish);\r\n  return Number.isNaN(ms) ? NaN : ms;\r\n}\r\n\r\n// \"2025-12-25~2025-12-26\" -> [ms, ms]\r\nfunction parseDateRange(s) {\r\n  if (!s) return [NaN, NaN];\r\n  const [a, b] = String(s).split(\"~\").map(v => v && v.trim());\r\n  const sMs = a ? Date.parse(a) : NaN;\r\n  const eMs = b ? Date.parse(b) : sMs;\r\n  return [sMs, eMs];\r\n}\r\n\r\n// 카테고리 상위 매핑\r\nfunction toHighLevelCategory(codename = \"\", themecode = \"\") {\r\n  const c = String(codename);\r\n  if ([\"콘서트\",\"클래식\",\"국악\",\"무용\",\"연극\",\"뮤지컬/오페라\",\"축제-기타\"].some(k => c.includes(k))) return \"공연\";\r\n  if (c.includes(\"전시/미술\")) return \"전시\";\r\n  if (c.includes(\"교육/체험\") || String(themecode).includes(\"교육\")) return \"교육/체험\";\r\n  return \"기타\";\r\n}\r\n\r\n// URL 중간에 공백 섞여 온 케이스 보정\r\nfunction cleanUrl(u) {\r\n  if (!u) return \"\";\r\n  return String(u).replace(/\\s+/g, \"\");\r\n}\r\n\r\n// 자치구 오타 보정(예: \"관구악\" -> \"관악구\")\r\nfunction normalizeGuName(g) {\r\n  const s = String(g || \"\").trim();\r\n  if (s === \"관구악\") return \"관악구\";\r\n  return s || \"기타\";\r\n}\r\n\r\n// --- 핵심: 어떤 JSON이 와도 공통 필드로 정규화 ---\r\nfunction normalize(raw) {\r\n  if (!raw) return [];\r\n\r\n  // ① 정적 JSON(예: { DESCRIPTION, DATA: [...] }) 형태\r\n  if (raw.DATA && Array.isArray(raw.DATA)) {\r\n    return raw.DATA.map((e, idx) => {\r\n      // 수치형 타임스탬프(ms)로 오는 케이스 지원\r\n      const sMs = Number(e.strtdate);\r\n      const eMs = Number(e.end_date);\r\n      return {\r\n        id: `${e.title || \"ev\"}-${e.strtdate || e.date || idx}`,\r\n        title: e.title,\r\n        categoryHL: toHighLevelCategory(e.codename, e.themecode),\r\n        dateText: e.date,\r\n        place: e.place,\r\n        area: normalizeGuName(e.guname),\r\n        img: e.main_img || \"/images/no-image.png\",\r\n        link: cleanUrl(e.hmpg_addr || e.org_link),\r\n        startMs: Number.isNaN(sMs) ? NaN : sMs,\r\n        endMs: Number.isNaN(eMs) ? sMs : eMs,\r\n      };\r\n    });\r\n  }\r\n\r\n  // ② 서울시 OpenAPI 응답({ cultureEventInfo: { row: [...] } })\r\n  const rows = raw.cultureEventInfo?.row;\r\n  if (Array.isArray(rows)) {\r\n    return rows.map((r, idx) => {\r\n      // 대문자 키 정리\r\n      const title = r.TITLE;\r\n      const dateText = r.DATE;\r\n      const [sFromDate, sToDate] = parseDateRange(dateText);\r\n      const sMs = parseDateTimeLoose(r.STRTDATE) || sFromDate;\r\n      const eMs = parseDateTimeLoose(r.END_DATE) || sToDate || sMs;\r\n\r\n      return {\r\n        id: `${title || \"ev\"}-${r.STRTDATE || r.DATE || idx}`,\r\n        title,\r\n        categoryHL: toHighLevelCategory(r.CODENAME, r.THEMECODE),\r\n        dateText,\r\n        place: r.PLACE,\r\n        area: normalizeGuName(r.GUNAME),\r\n        img: r.MAIN_IMG || \"/images/no-image.png\",\r\n        link: cleanUrl(r.HMPG_ADDR || r.ORG_LINK),\r\n        startMs: sMs,\r\n        endMs: eMs,\r\n      };\r\n    });\r\n  }\r\n\r\n  return [];\r\n}\r\n\r\nexport default function useEvents(source = \"/data/seoul_api.json\") {\r\n  const [events, setEvents] = useState([]);\r\n\r\n  useEffect(() => {\r\n    fetch(source)\r\n      .then(res => res.json())\r\n      .then(json => setEvents(normalize(json)))\r\n      .catch(() => setEvents([]));\r\n  }, [source]);\r\n\r\n  return events;\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}